\todo{consider implementing a WOT system with levels of trust}
\todo{turn all these lists into real text}

\section{Registration}
Users may register by sending a CLAIM message to the server, this will claim a
username for that user, and allow people they send messages to to see their
username.

Before registering the user must generate an RSA keypair, they will be given the
option of generating a new keypair, or using an existing keypair. The keypair
provided will be encrypted using AES with the users password being used to
derive the key. The user therefore must enter their password to log in to the
client. The database will be encrypted using the same AES key as the keys are
encrypted with.

\section{Interacting with other users}
People are adding by adding their public key, this is transmitted outside of our
system, via whichever channel the users deem appropriate\footnote{This is
required to prevent server operators from MitM'ing users}.

Adding someone is asymmetric. Just because you add them doesn't mean they've
added you. You do not require consent to add someone, just their public key.
    
The system allows the user to manage their list of known people into groups such
as friends, family, and cooworkers. The user defines these groups as lists of
people whose public key they know. The user may create any group they desire,
these groups are visible to only the user, and private\todo{groups should be
posted to the server as a message only that user can read, this supports the
same user using multiple clients (on, say, a phone and laptop)}.

\section{Profile Data}
Profile data will be transmitted via PDATA messages. Different versions of
profile information may be provided to different groups of people. Profile data
may be update by the user.

The supported fields in a PDATA message are:
    \begin{itemize}
        \item Name
        \item Username (unique, but this uniqueness is ensured by server and
              shouldn't be relied on)
        \item Birthday
        \item Sex
        \item E-Mail
        \item About
    \end{itemize}

\section{Account recovery}
Account recovery is not possible without your keypair, due to the the GUI should
urge the user to keep a copy on a flash drive, or external hard drive. The keys
themselved will be encrypted with the users password.

\section{Posts}
\subsection{Walls}
Each user has their own wall. On their wall they may posts messages for
themselves and others to see. All wall posts should be addressed to the user
themself so they can see their own posts, otherwise they will be unable to even
view their own posts. When posting to their wall they choose who will be able to
see the post, whether this is a group or people, a specific list of people, or
just themselves is up to the user. They will not however be given the option to
post publically. Users may also post to another users wall.

Wall posts may contain links to other content, however this content is never
thumbnailed\footnote{client MUST NEVER thumbnail link or otherwise access it
without EXPLICIT user consent (see tor/js exploit on freedom hosting by the USA
and tracking techniques recently thwarted by GMail caching images}.

A user may edit their old posts, however older versions will still be available
for viewing; similarly users may 'delete' posts, but they are still visible to
malicious clients.

Due to bandwidth limitations on such networks as we are building, a user may
only post plaintext, they may not post images, video, or audio.

\subsection{Commenting}
All wall posts may be commented on by any user who can see them. Comments are
visible to all people who can see the original post; due to this comments must
be forwarded by original posters client to all the same recipients, as the
commenter may not know whom the original posters allowed to see the post.
    
\subsection{Liking}
Any wall post may be liked. Likes are simply a specially formatted comment
which contains only the text: "__LIKE__". As such they are handled in the same
way\todo{inband metadata is probably a bad idea}.
    
\subsection{Events}
The client will alert the user to other users birthdays by automatically posting
a wall post that only the user may read, which alerts the user of the event.
These are normal wall posts.

\section{Chat}
Users may chat in real time, however messages can still be sent when one user
logs off, to be recieved when they log in. Past conversations are saved, and a
user may block users from messaging them; the client actually just ignores their
messages, it's impossible to stop someone from messaging you.
