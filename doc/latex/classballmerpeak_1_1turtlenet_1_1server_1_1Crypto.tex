\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto}{\subsection{ballmerpeak.\-turtlenet.\-server.\-Crypto Class Reference}
\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto}\index{ballmerpeak.\-turtlenet.\-server.\-Crypto@{ballmerpeak.\-turtlenet.\-server.\-Crypto}}
}
\subsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static Boolean \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a4d363a946bc16a383bb3516a6819e06f}{keys\-Exist} ()
\begin{DoxyCompactList}\small\item\em Check whether the user has a keypair. \end{DoxyCompactList}\item 
static void \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3a1070020af2f98bfb23284115f1b97}{key\-Gen} ()
\begin{DoxyCompactList}\small\item\em Generate an R\-S\-A keypair. \end{DoxyCompactList}\item 
static boolean \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a028cefbca14291fa686b27c36f3b212a}{encrypt\-D\-B} (String password)
\begin{DoxyCompactList}\small\item\em Encrypt local data store. \end{DoxyCompactList}\item 
static boolean \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a0faed916bbc35f2f01c4a09a52c008df}{decrypt\-D\-B} (String password)
\begin{DoxyCompactList}\small\item\em Decrypt local data store. \end{DoxyCompactList}\item 
static Key\-Pair \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a2e95210ca85eb6273d47a1bde6be22e4}{get\-Test\-Key} ()
\begin{DoxyCompactList}\small\item\em Get a keypair for testing purposes. \end{DoxyCompactList}\item 
static Public\-Key \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a830f62b5e45e6d1f424c3340b80d90c2}{get\-Public\-Key} ()
\begin{DoxyCompactList}\small\item\em Get the current users public key. \end{DoxyCompactList}\item 
static Private\-Key \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_af6bfe6ea68cff3020c22221361f2d7f2}{get\-Private\-Key} ()
\begin{DoxyCompactList}\small\item\em Get the current users private key. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a3551509d86a909950bb4c44ae1803240}{sign} (\hyperlink{classballmerpeak_1_1turtlenet_1_1shared_1_1Message}{Message} msg)
\begin{DoxyCompactList}\small\item\em Generate the appropriate signature for a message. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aaa857c040134654c8d6187cb4f4090b5}{sign} (\hyperlink{classballmerpeak_1_1turtlenet_1_1shared_1_1Message}{Message} msg, Private\-Key k)
\begin{DoxyCompactList}\small\item\em Generate the appropriate signature for a message. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a359e1b82e7bf6ff8018bed7829850def}{hash} (String data)
\begin{DoxyCompactList}\small\item\em Hash a string. \end{DoxyCompactList}\item 
static boolean \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae5bdc4040fce3773ce9d5718d3bf8d0b}{verify\-Sig} (\hyperlink{classballmerpeak_1_1turtlenet_1_1shared_1_1Message}{Message} msg, Public\-Key author)
\begin{DoxyCompactList}\small\item\em Verify a signature. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3b4ea7217b7e91abd1d42f932611c85}{encrypt} (\hyperlink{classballmerpeak_1_1turtlenet_1_1shared_1_1Message}{Message} msg, Public\-Key recipient, \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1NetworkConnection}{Network\-Connection} connection)
\begin{DoxyCompactList}\small\item\em Encrypt a message. \end{DoxyCompactList}\item 
static \hyperlink{classballmerpeak_1_1turtlenet_1_1shared_1_1Message}{Message} \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a74c30e340ade0ff1729abe05c772d3f7}{decrypt} (String msg)
\begin{DoxyCompactList}\small\item\em Decrypt a message. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ac3423c536327620f518dab7f55d85b20}{encode\-Key} (Public\-Key key)
\begin{DoxyCompactList}\small\item\em Encode a Public\-Key as a String. \end{DoxyCompactList}\item 
static Public\-Key \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a78b5adee9b8deda2f2558fcc9aa3aa4b}{decode\-Key} (String coded\-Key)
\begin{DoxyCompactList}\small\item\em Decode a string representation of a Public\-Key. \end{DoxyCompactList}\item 
static String \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9a8cf56daec604a46eff71fd42b21eef}{Base64\-Encode} (byte\mbox{[}$\,$\mbox{]} data)
\begin{DoxyCompactList}\small\item\em Encode a byte\mbox{[}\mbox{]} as a string. \end{DoxyCompactList}\item 
static byte\mbox{[}$\,$\mbox{]} \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9ff76fd9368082d0e3fa77c9687d8bee}{Base64\-Decode} (String data)
\begin{DoxyCompactList}\small\item\em Decode a string representation of a byte\mbox{[}\mbox{]} Uses base64 encoding. \end{DoxyCompactList}\item 
static int \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a226d168b01eb7f6c9b1c5c0984528a41}{rand} (int min, int max)
\begin{DoxyCompactList}\small\item\em Get a random number. \end{DoxyCompactList}\item 
static byte\mbox{[}$\,$\mbox{]} \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_abfc04f2d0f6f92bcca41c53b6cdc667d}{encrypt\-Bytes} (byte\mbox{[}$\,$\mbox{]} data, String key)
\begin{DoxyCompactList}\small\item\em A\-E\-S Encrypt data. \end{DoxyCompactList}\item 
static byte\mbox{[}$\,$\mbox{]} \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aea88564254a1c6c217042419f304c1ef}{decrypt\-Bytes} (byte\mbox{[}$\,$\mbox{]} data, String key)
\begin{DoxyCompactList}\small\item\em Decrypt A\-E\-S data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static Secure\-Random {\bfseries srand}
\end{DoxyCompactItemize}
\subsubsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static byte\mbox{[}$\,$\mbox{]} \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae27396e1a327d1fc2eba6f7ccd53defc}{get\-A\-E\-S\-Key} (String password)
\begin{DoxyCompactList}\small\item\em Derives a byte\mbox{[}\mbox{]} suitable for constructing an A\-E\-S key from a string. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}


Definition at line 18 of file Crypto.\-java.



\subsubsection{Member Function Documentation}
\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9ff76fd9368082d0e3fa77c9687d8bee}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!Base64\-Decode@{Base64\-Decode}}
\index{Base64\-Decode@{Base64\-Decode}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{Base64\-Decode}]{\setlength{\rightskip}{0pt plus 5cm}static byte \mbox{[}$\,$\mbox{]} ballmerpeak.\-turtlenet.\-server.\-Crypto.\-Base64\-Decode (
\begin{DoxyParamCaption}
\item[{String}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9ff76fd9368082d0e3fa77c9687d8bee}


Decode a string representation of a byte\mbox{[}\mbox{]} Uses base64 encoding. 


\begin{DoxyParams}{Parameters}
{\em data} & The string to decode. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The byte\mbox{[}\mbox{]} data represents. 
\end{DoxyReturn}


Definition at line 378 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9a8cf56daec604a46eff71fd42b21eef}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!Base64\-Encode@{Base64\-Encode}}
\index{Base64\-Encode@{Base64\-Encode}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{Base64\-Encode}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-Base64\-Encode (
\begin{DoxyParamCaption}
\item[{byte\mbox{[}$\,$\mbox{]}}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a9a8cf56daec604a46eff71fd42b21eef}


Encode a byte\mbox{[}\mbox{]} as a string. 

Uses base64 encoding. 
\begin{DoxyParams}{Parameters}
{\em data} & The byte array to encode. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string representation of data. 
\end{DoxyReturn}


Definition at line 369 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a78b5adee9b8deda2f2558fcc9aa3aa4b}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!decode\-Key@{decode\-Key}}
\index{decode\-Key@{decode\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{decode\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static Public\-Key ballmerpeak.\-turtlenet.\-server.\-Crypto.\-decode\-Key (
\begin{DoxyParamCaption}
\item[{String}]{coded\-Key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a78b5adee9b8deda2f2558fcc9aa3aa4b}


Decode a string representation of a Public\-Key. 


\begin{DoxyParams}{Parameters}
{\em coded\-Key} & The encoded public key to decode. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Public\-Key encoded in coded\-Key. 
\end{DoxyReturn}


Definition at line 350 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a74c30e340ade0ff1729abe05c772d3f7}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!decrypt@{decrypt}}
\index{decrypt@{decrypt}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{decrypt}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Message} ballmerpeak.\-turtlenet.\-server.\-Crypto.\-decrypt (
\begin{DoxyParamCaption}
\item[{String}]{msg}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a74c30e340ade0ff1729abe05c772d3f7}


Decrypt a message. 

Uses an R\-S\-A header with the main ciphertext being A\-E\-S encrypted. There are significant speed advantages to this given most modern C\-P\-Us have A\-E\-S as part of the instruction set.

Message is decrypted using the current users private key.


\begin{DoxyParams}{Parameters}
{\em msg} & The message to decryot. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The decrypted message. 
\end{DoxyReturn}


Definition at line 294 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aea88564254a1c6c217042419f304c1ef}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!decrypt\-Bytes@{decrypt\-Bytes}}
\index{decrypt\-Bytes@{decrypt\-Bytes}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{decrypt\-Bytes}]{\setlength{\rightskip}{0pt plus 5cm}static byte \mbox{[}$\,$\mbox{]} ballmerpeak.\-turtlenet.\-server.\-Crypto.\-decrypt\-Bytes (
\begin{DoxyParamCaption}
\item[{byte\mbox{[}$\,$\mbox{]}}]{data, }
\item[{String}]{key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aea88564254a1c6c217042419f304c1ef}


Decrypt A\-E\-S data. 

Decrypts A\-E\-S encrypted byte\mbox{[}\mbox{]}s using a key derived from key. 
\begin{DoxyParams}{Parameters}
{\em data} & The data to decrypt. \\
\hline
{\em key} & The string from which the key is derived. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
decrypted data. 
\end{DoxyReturn}


Definition at line 416 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a0faed916bbc35f2f01c4a09a52c008df}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!decrypt\-D\-B@{decrypt\-D\-B}}
\index{decrypt\-D\-B@{decrypt\-D\-B}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{decrypt\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}static boolean ballmerpeak.\-turtlenet.\-server.\-Crypto.\-decrypt\-D\-B (
\begin{DoxyParamCaption}
\item[{String}]{password}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a0faed916bbc35f2f01c4a09a52c008df}


Decrypt local data store. 

Decrypts all files in the db folder with A\-E\-S-\/128. Removes the trailing .aes from the filename 
\begin{DoxyParams}{Parameters}
{\em password} & The password used to derive the A\-E\-S key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true of success, false otherwise. 
\end{DoxyReturn}


Definition at line 98 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ac3423c536327620f518dab7f55d85b20}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!encode\-Key@{encode\-Key}}
\index{encode\-Key@{encode\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{encode\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-encode\-Key (
\begin{DoxyParamCaption}
\item[{Public\-Key}]{key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ac3423c536327620f518dab7f55d85b20}


Encode a Public\-Key as a String. 


\begin{DoxyParams}{Parameters}
{\em key} & The Public\-Key to encode. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A string representation of key. 
\end{DoxyReturn}


Definition at line 337 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3b4ea7217b7e91abd1d42f932611c85}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!encrypt@{encrypt}}
\index{encrypt@{encrypt}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{encrypt}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-encrypt (
\begin{DoxyParamCaption}
\item[{{\bf Message}}]{msg, }
\item[{Public\-Key}]{recipient, }
\item[{{\bf Network\-Connection}}]{connection}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3b4ea7217b7e91abd1d42f932611c85}


Encrypt a message. 

Uses an R\-S\-A header with the main ciphertext being A\-E\-S encrypted. There are significant speed advantages to this given most modern C\-P\-Us have A\-E\-S as part of the instruction set.

Message is encrypted using the current users private key.

Time differentials can, and have, been used to corrolate otherwise anonymous messages; therefore server time is used. This is not to protect against malicious server operators, but operators ordered after the fact to provide the data they've collected.

The \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1NetworkConnection}{Network\-Connection} is used to get the servers time. 
\begin{DoxyParams}{Parameters}
{\em msg} & The message to encrypt. \\
\hline
{\em recipient} & The public key that should be used to encrypt the message. \\
\hline
{\em connection} & A network connection to the server you intend to send this message to. Used to get a timestamp. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The encrypted message as a string. 
\end{DoxyReturn}


Definition at line 254 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_abfc04f2d0f6f92bcca41c53b6cdc667d}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!encrypt\-Bytes@{encrypt\-Bytes}}
\index{encrypt\-Bytes@{encrypt\-Bytes}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{encrypt\-Bytes}]{\setlength{\rightskip}{0pt plus 5cm}static byte \mbox{[}$\,$\mbox{]} ballmerpeak.\-turtlenet.\-server.\-Crypto.\-encrypt\-Bytes (
\begin{DoxyParamCaption}
\item[{byte\mbox{[}$\,$\mbox{]}}]{data, }
\item[{String}]{key}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_abfc04f2d0f6f92bcca41c53b6cdc667d}


A\-E\-S Encrypt data. 

A\-E\-S encrypts a byte\mbox{[}\mbox{]} using A\-E\-S and a key derived from key. 
\begin{DoxyParams}{Parameters}
{\em data} & The data to encrypt. \\
\hline
{\em key} & The string from which the key is derived. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
data encrypted using A\-E\-S. 
\end{DoxyReturn}


Definition at line 398 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a028cefbca14291fa686b27c36f3b212a}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!encrypt\-D\-B@{encrypt\-D\-B}}
\index{encrypt\-D\-B@{encrypt\-D\-B}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{encrypt\-D\-B}]{\setlength{\rightskip}{0pt plus 5cm}static boolean ballmerpeak.\-turtlenet.\-server.\-Crypto.\-encrypt\-D\-B (
\begin{DoxyParamCaption}
\item[{String}]{password}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a028cefbca14291fa686b27c36f3b212a}


Encrypt local data store. 

encrypts all files in the db folder with A\-E\-S-\/128. Renames files to $<$filename$>$.aes 
\begin{DoxyParams}{Parameters}
{\em password} & The password used to derive the A\-E\-S key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true of success, false otherwise. 
\end{DoxyReturn}


Definition at line 72 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae27396e1a327d1fc2eba6f7ccd53defc}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!get\-A\-E\-S\-Key@{get\-A\-E\-S\-Key}}
\index{get\-A\-E\-S\-Key@{get\-A\-E\-S\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{get\-A\-E\-S\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static byte \mbox{[}$\,$\mbox{]} ballmerpeak.\-turtlenet.\-server.\-Crypto.\-get\-A\-E\-S\-Key (
\begin{DoxyParamCaption}
\item[{String}]{password}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae27396e1a327d1fc2eba6f7ccd53defc}


Derives a byte\mbox{[}\mbox{]} suitable for constructing an A\-E\-S key from a string. 


\begin{DoxyParams}{Parameters}
{\em password} & The string from which to derive a byte\mbox{[}\mbox{]}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A byte\mbox{[}\mbox{]} suitable for constructing an A\-E\-S key. 
\end{DoxyReturn}


Definition at line 432 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_af6bfe6ea68cff3020c22221361f2d7f2}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!get\-Private\-Key@{get\-Private\-Key}}
\index{get\-Private\-Key@{get\-Private\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{get\-Private\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static Private\-Key ballmerpeak.\-turtlenet.\-server.\-Crypto.\-get\-Private\-Key (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_af6bfe6ea68cff3020c22221361f2d7f2}


Get the current users private key. 

\begin{DoxyReturn}{Returns}
The current users Private\-Key 
\end{DoxyReturn}


Definition at line 152 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a830f62b5e45e6d1f424c3340b80d90c2}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!get\-Public\-Key@{get\-Public\-Key}}
\index{get\-Public\-Key@{get\-Public\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{get\-Public\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static Public\-Key ballmerpeak.\-turtlenet.\-server.\-Crypto.\-get\-Public\-Key (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a830f62b5e45e6d1f424c3340b80d90c2}


Get the current users public key. 

\begin{DoxyReturn}{Returns}
The current users Public\-Key. 
\end{DoxyReturn}


Definition at line 137 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a2e95210ca85eb6273d47a1bde6be22e4}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!get\-Test\-Key@{get\-Test\-Key}}
\index{get\-Test\-Key@{get\-Test\-Key}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{get\-Test\-Key}]{\setlength{\rightskip}{0pt plus 5cm}static Key\-Pair ballmerpeak.\-turtlenet.\-server.\-Crypto.\-get\-Test\-Key (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a2e95210ca85eb6273d47a1bde6be22e4}


Get a keypair for testing purposes. 


\begin{DoxyParams}{Parameters}
{\em bar} & baz. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An R\-S\-A Key\-Pair 
\end{DoxyReturn}


Definition at line 122 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a359e1b82e7bf6ff8018bed7829850def}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!hash@{hash}}
\index{hash@{hash}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{hash}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-hash (
\begin{DoxyParamCaption}
\item[{String}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a359e1b82e7bf6ff8018bed7829850def}


Hash a string. 

Uses S\-H\-A-\/256. 
\begin{DoxyParams}{Parameters}
{\em data} & The text to hash. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The S\-H\-A-\/256 hash of the data. 
\end{DoxyReturn}


Definition at line 201 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3a1070020af2f98bfb23284115f1b97}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!key\-Gen@{key\-Gen}}
\index{key\-Gen@{key\-Gen}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{key\-Gen}]{\setlength{\rightskip}{0pt plus 5cm}static void ballmerpeak.\-turtlenet.\-server.\-Crypto.\-key\-Gen (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae3a1070020af2f98bfb23284115f1b97}


Generate an R\-S\-A keypair. 

Stores the keys in \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1Database_a3933689115f43166439d740b2a254481}{Database.\-path} + public/private .key They are automatically encrypted by \hyperlink{classballmerpeak_1_1turtlenet_1_1server_1_1TNClient}{T\-N\-Client}. 

Definition at line 37 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a4d363a946bc16a383bb3516a6819e06f}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!keys\-Exist@{keys\-Exist}}
\index{keys\-Exist@{keys\-Exist}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{keys\-Exist}]{\setlength{\rightskip}{0pt plus 5cm}static Boolean ballmerpeak.\-turtlenet.\-server.\-Crypto.\-keys\-Exist (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a4d363a946bc16a383bb3516a6819e06f}


Check whether the user has a keypair. 

\begin{DoxyReturn}{Returns}
true is the user has a keypair, false otherwise. 
\end{DoxyReturn}


Definition at line 27 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a226d168b01eb7f6c9b1c5c0984528a41}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!rand@{rand}}
\index{rand@{rand}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{rand}]{\setlength{\rightskip}{0pt plus 5cm}static int ballmerpeak.\-turtlenet.\-server.\-Crypto.\-rand (
\begin{DoxyParamCaption}
\item[{int}]{min, }
\item[{int}]{max}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a226d168b01eb7f6c9b1c5c0984528a41}


Get a random number. 


\begin{DoxyParams}{Parameters}
{\em min} & The minimum value to return, inclusive. \\
\hline
{\em max} & The maximum value to return, exclusive. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a random integer between min and max (inclusive.) 
\end{DoxyReturn}


Definition at line 387 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a3551509d86a909950bb4c44ae1803240}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!sign@{sign}}
\index{sign@{sign}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{sign}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-sign (
\begin{DoxyParamCaption}
\item[{{\bf Message}}]{msg}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_a3551509d86a909950bb4c44ae1803240}


Generate the appropriate signature for a message. 

Returns the appropriate signature for the given message as a string. Signature is created using the current users private key. 
\begin{DoxyParams}{Parameters}
{\em msg} & The message to sign. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A signature of msg by the current users private key. 
\end{DoxyReturn}


Definition at line 170 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aaa857c040134654c8d6187cb4f4090b5}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!sign@{sign}}
\index{sign@{sign}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{sign}]{\setlength{\rightskip}{0pt plus 5cm}static String ballmerpeak.\-turtlenet.\-server.\-Crypto.\-sign (
\begin{DoxyParamCaption}
\item[{{\bf Message}}]{msg, }
\item[{Private\-Key}]{k}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_aaa857c040134654c8d6187cb4f4090b5}


Generate the appropriate signature for a message. 

Returns the appropriate signature for the given message as a string. Signature is created using the given key. 
\begin{DoxyParams}{Parameters}
{\em msg} & The message to sign. \\
\hline
{\em k} & The key to sign with. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A signature of msg by k. 
\end{DoxyReturn}


Definition at line 182 of file Crypto.\-java.

\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae5bdc4040fce3773ce9d5718d3bf8d0b}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!verify\-Sig@{verify\-Sig}}
\index{verify\-Sig@{verify\-Sig}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{verify\-Sig}]{\setlength{\rightskip}{0pt plus 5cm}static boolean ballmerpeak.\-turtlenet.\-server.\-Crypto.\-verify\-Sig (
\begin{DoxyParamCaption}
\item[{{\bf Message}}]{msg, }
\item[{Public\-Key}]{author}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ae5bdc4040fce3773ce9d5718d3bf8d0b}


Verify a signature. 


\begin{DoxyParams}{Parameters}
{\em msg} & The message that's been signed. \\
\hline
{\em author} & The key suspected to be the author of the signature. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true is author signed msg, false otherwise. 
\end{DoxyReturn}


Definition at line 216 of file Crypto.\-java.



\subsubsection{Member Data Documentation}
\hypertarget{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ad2ae6688f871ae46b7a5ae98b35d7000}{\index{ballmerpeak\-::turtlenet\-::server\-::\-Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}!srand@{srand}}
\index{srand@{srand}!ballmerpeak::turtlenet::server::Crypto@{ballmerpeak\-::turtlenet\-::server\-::\-Crypto}}
\paragraph[{srand}]{\setlength{\rightskip}{0pt plus 5cm}Secure\-Random ballmerpeak.\-turtlenet.\-server.\-Crypto.\-srand\hspace{0.3cm}{\ttfamily [static]}}}\label{classballmerpeak_1_1turtlenet_1_1server_1_1Crypto_ad2ae6688f871ae46b7a5ae98b35d7000}
{\bfseries Initial value\-:}
\begin{DoxyCode}
 \textcolor{keyword}{new} SecureRandom(
                                               Long.toString(
                                                   System.currentTimeMillis())
                                               .getBytes())
\end{DoxyCode}


Definition at line 19 of file Crypto.\-java.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
src/ballmerpeak/turtlenet/server/Crypto.\-java\end{DoxyCompactItemize}
